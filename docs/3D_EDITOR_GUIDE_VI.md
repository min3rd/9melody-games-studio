# TrÃ¬nh Chá»‰nh Sá»­a 3D cho Khung Cáº£nh Trang Chá»§

TÃ­nh nÄƒng nÃ y cung cáº¥p má»™t trÃ¬nh chá»‰nh sá»­a 3D toÃ n diá»‡n Ä‘á»ƒ táº¡o vÃ  tÃ¹y chá»‰nh cÃ¡c khung cáº£nh 3D hiá»ƒn thá»‹ trÃªn trang chá»§.

## Tá»•ng Quan

TrÃ¬nh chá»‰nh sá»­a 3D náº±m táº¡i `/private/admin/3d-editor` vÃ  cung cáº¥p giao diá»‡n chuyÃªn nghiá»‡p Ä‘á»ƒ quáº£n lÃ½ cÃ¡c khung cáº£nh 3D vá»›i cÃ¡c tÃ­nh nÄƒng sau:

### TÃ­nh NÄƒng ChÃ­nh

1. **Báº£ng Cáº¥u TrÃºc Cáº£nh** (Thanh BÃªn TrÃ¡i)
   - Xem táº¥t cáº£ cÃ¡c váº­t thá»ƒ trong cáº£nh
   - ThÃªm váº­t thá»ƒ má»›i (ğŸ“¦), Ã¡nh sÃ¡ng (ğŸ’¡), hoáº·c nhÃ³m (ğŸ“)
   - Chá»n, Ä‘á»•i tÃªn, hoáº·c xÃ³a váº­t thá»ƒ
   - Cáº¥u trÃºc trá»±c quan vá»›i biá»ƒu tÆ°á»£ng

2. **Khung NhÃ¬n 3D** (Trung TÃ¢m)
   - Káº¿t xuáº¥t 3D thá»i gian thá»±c sá»­ dá»¥ng React Three Fiber
   - Äiá»u khiá»ƒn camera tÆ°Æ¡ng tÃ¡c:
     - **Xoay**: Click trÃ¡i + kÃ©o
     - **Di chuyá»ƒn**: Click pháº£i + kÃ©o
     - **PhÃ³ng to**: Cuá»™n chuá»™t
   - LÆ°á»›i há»— trá»£ tham chiáº¿u khÃ´ng gian
   - Äiá»u khiá»ƒn biáº¿n Ä‘á»•i cho váº­t thá»ƒ Ä‘Æ°á»£c chá»n

3. **Báº£ng Thuá»™c TÃ­nh** (Thanh BÃªn Pháº£i)
   - Chá»‰nh sá»­a thuá»™c tÃ­nh váº­t thá»ƒ:
     - **Biáº¿n Äá»•i**: Vá»‹ trÃ­ (X, Y, Z), Xoay (X, Y, Z), Tá»‰ lá»‡ (X, Y, Z)
     - **HÃ¬nh Thá»©c**: MÃ u sáº¯c, Cháº¿ Ä‘á»™ khung dÃ¢y (cho váº­t thá»ƒ)
     - **CÃ i Äáº·t Ãnh SÃ¡ng**: CÆ°á»ng Ä‘á»™, MÃ u sáº¯c (cho Ã¡nh sÃ¡ng)
   - Cáº­p nháº­t thá»i gian thá»±c trong khung nhÃ¬n

4. **ThÆ° Viá»‡n Váº­t Thá»ƒ** (Báº£ng DÆ°á»›i)
   - Duyá»‡t cÃ¡c váº­t thá»ƒ 3D cÃ³ sáºµn
   - **HÃ¬nh CÆ¡ Báº£n**: Há»™p, Cáº§u, HÃ¬nh Trá»¥
   - **ThÃ nh Pháº§n 3D**: Äáº£o, CÃ¡t, Äáº¡i DÆ°Æ¡ng, MÃ¢y, ÄÃ¡, GiÃ³
   - Click vÃ o váº­t thá»ƒ Ä‘á»ƒ thÃªm vÃ o cáº£nh
   - Chuyá»ƒn Ä‘á»•i cháº¿ Ä‘á»™ lÆ°á»›i/danh sÃ¡ch
   - Chá»©c nÄƒng tÃ¬m kiáº¿m

## HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng

### Táº¡o Má»™t Cáº£nh

1. **Truy Cáº­p TrÃ¬nh Chá»‰nh Sá»­a**
   - Äiá»u hÆ°á»›ng Ä‘áº¿n `/private/admin/3d-editor` (yÃªu cáº§u xÃ¡c thá»±c admin)

2. **ThÃªm Váº­t Thá»ƒ VÃ o Cáº£nh**
   - **CÃ¡ch 1**: Click nÃºt `+ ğŸ“¦` trong Báº£ng Cáº¥u TrÃºc
   - **CÃ¡ch 2**: Click vÃ o má»™t váº­t thá»ƒ trong báº£ng ThÆ° Viá»‡n Váº­t Thá»ƒ
   - Váº­t thá»ƒ sáº½ xuáº¥t hiá»‡n trong khung nhÃ¬n vÃ  cáº¥u trÃºc

3. **Äá»‹nh Vá»‹ vÃ  Biáº¿n Äá»•i Váº­t Thá»ƒ**
   - Click vÃ o váº­t thá»ƒ trong khung nhÃ¬n hoáº·c cáº¥u trÃºc Ä‘á»ƒ chá»n
   - Sá»­ dá»¥ng Báº£ng Thuá»™c TÃ­nh Ä‘á»ƒ Ä‘iá»u chá»‰nh:
     - Vá»‹ trÃ­: Di chuyá»ƒn váº­t thá»ƒ trong khÃ´ng gian 3D
     - Xoay: Xoay váº­t thá»ƒ quanh cÃ¡c trá»¥c X, Y, Z
     - Tá»‰ lá»‡: Thay Ä‘á»•i kÃ­ch thÆ°á»›c váº­t thá»ƒ
   - Hoáº·c sá»­ dá»¥ng Ä‘iá»u khiá»ƒn biáº¿n Ä‘á»•i trá»±c tiáº¿p trong khung nhÃ¬n (khi cÃ³ sáºµn)

4. **TÃ¹y Chá»‰nh HÃ¬nh Thá»©c**
   - Chá»n má»™t váº­t thá»ƒ
   - Trong Báº£ng Thuá»™c TÃ­nh, Ä‘iá»u chá»‰nh:
     - **MÃ u Sáº¯c**: Click bá»™ chá»n mÃ u Ä‘á»ƒ chá»n mÃ u
     - **Khung DÃ¢y**: Báº­t/táº¯t Ä‘á»ƒ hiá»ƒn thá»‹ váº­t thá»ƒ dáº¡ng khung dÃ¢y

5. **ThÃªm Ãnh SÃ¡ng**
   - Click `+ ğŸ’¡` trong Báº£ng Cáº¥u TrÃºc
   - Äiá»u chá»‰nh vá»‹ trÃ­ vÃ  cÆ°á»ng Ä‘á»™ Ã¡nh sÃ¡ng trong Báº£ng Thuá»™c TÃ­nh
   - Thay Ä‘á»•i mÃ u Ã¡nh sÃ¡ng cho hiá»‡u á»©ng khÃ¡c nhau

6. **LÆ°u Cáº£nh Cá»§a Báº¡n**
   - Click nÃºt **ğŸ’¾ LÆ°u** trÃªn thanh cÃ´ng cá»¥
   - Cáº¥u hÃ¬nh cáº£nh Ä‘Æ°á»£c lÆ°u vÃ o localStorage cá»§a trÃ¬nh duyá»‡t
   - Báº¡n sáº½ tháº¥y thÃ´ng bÃ¡o xÃ¡c nháº­n

7. **Táº£i Cáº£nh ÄÃ£ LÆ°u**
   - Click nÃºt **ğŸ“‚ Táº£i** trÃªn thanh cÃ´ng cá»¥
   - Cáº£nh Ä‘Ã£ lÆ°u trÆ°á»›c Ä‘Ã³ sáº½ Ä‘Æ°á»£c khÃ´i phá»¥c

### Xem TrÃªn Trang Chá»§

Cáº£nh 3D Ä‘Ã£ lÆ°u sáº½ tá»± Ä‘á»™ng hiá»ƒn thá»‹ trÃªn trang chá»§ (`/`):

- Cáº£nh Ä‘Æ°á»£c táº£i tá»« cáº¥u hÃ¬nh Ä‘Ã£ lÆ°u
- Äiá»u khiá»ƒn tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c báº­t (ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ xoay vÃ  phÃ³ng to cáº£nh)
- Náº¿u khÃ´ng cÃ³ cáº£nh nÃ o Ä‘Æ°á»£c cáº¥u hÃ¬nh, má»™t cáº£nh máº·c Ä‘á»‹nh vá»›i cÃ¡c hÃ¬nh cÆ¡ báº£n sáº½ hiá»ƒn thá»‹

### LÆ°u Trá»¯ Cáº£nh

- **LÆ°u Trá»¯**: Cáº¥u hÃ¬nh cáº£nh hiá»‡n Ä‘ang Ä‘Æ°á»£c lÆ°u trong `localStorage` cá»§a trÃ¬nh duyá»‡t
- **KhÃ³a**: `homepage-scene-config`
- **Cáº¥u TrÃºc Dá»¯ Liá»‡u**:
  ```json
  {
    "objects": [...],
    "objectData": {
      "objectId": {
        "id": "...",
        "name": "...",
        "type": "box|sphere|cylinder|light|...",
        "position": [x, y, z],
        "rotation": [x, y, z],
        "scale": [x, y, z],
        "color": "#hex",
        "wireframe": boolean,
        "intensity": number
      }
    },
    "timestamp": "ISO date string"
  }
  ```

### Cáº£i Tiáº¿n Trong TÆ°Æ¡ng Lai (Tiá»m NÄƒng)

- **LÆ°u Trá»¯**: Chuyá»ƒn tá»« localStorage sang cÆ¡ sá»Ÿ dá»¯ liá»‡u/API Ä‘á»ƒ há»— trá»£ nhiá»u ngÆ°á»i dÃ¹ng
- **TÃ­ch Há»£p ThÃ nh Pháº§n 3D**: TÃ­ch há»£p Ä‘áº§y Ä‘á»§ vá»›i Island3D, Sand3D, Ocean3D, v.v.
- **Äiá»u Khiá»ƒn NÃ¢ng Cao**:
  - Chá»©c nÄƒng HoÃ n tÃ¡c/LÃ m láº¡i
  - Sao chÃ©p/DÃ¡n váº­t thá»ƒ
  - Quan há»‡ cha-con (nhÃ³m)
  - CÄƒn chá»‰nh theo lÆ°á»›i
- **Quáº£n LÃ½ Váº­t Thá»ƒ**:
  - Táº£i lÃªn mÃ´ hÃ¬nh 3D tÃ¹y chá»‰nh (.glb, .gltf)
  - Quáº£n lÃ½ texture
  - TrÃ¬nh chá»‰nh sá»­a material
- **TÃ¹y Chá»n Xuáº¥t**:
  - Xuáº¥t cáº£nh dÆ°á»›i dáº¡ng JSON
  - Xuáº¥t dÆ°á»›i dáº¡ng file .glb
  - Chia sáº» cáº¥u hÃ¬nh cáº£nh giá»¯a ngÆ°á»i dÃ¹ng

## Chi Tiáº¿t Ká»¹ Thuáº­t

### ThÃ nh Pháº§n

1. **Editor3DLayout** (`components/editor3d/Editor3DLayout.tsx`)
   - ThÃ nh pháº§n layout chÃ­nh
   - Quáº£n lÃ½ tráº¡ng thÃ¡i cáº£nh vÃ  dá»¯ liá»‡u váº­t thá»ƒ
   - Äiá»u phá»‘i giá»¯a táº¥t cáº£ cÃ¡c báº£ng

2. **Scene3DObject** (`components/editor3d/Scene3DObject.tsx`)
   - Káº¿t xuáº¥t tá»«ng váº­t thá»ƒ 3D trong trÃ¬nh chá»‰nh sá»­a
   - Xá»­ lÃ½ viá»‡c chá»n váº­t thá»ƒ
   - TÃ­ch há»£p TransformControls Ä‘á»ƒ thao tÃ¡c

3. **HomepageScene3D** (`components/HomepageScene3D/index.tsx`)
   - Hiá»ƒn thá»‹ cáº£nh Ä‘Ã£ lÆ°u trÃªn trang chá»§
   - Táº£i cáº¥u hÃ¬nh tá»« localStorage
   - Káº¿t xuáº¥t váº­t thá»ƒ khÃ´ng cÃ³ Ä‘iá»u khiá»ƒn trÃ¬nh chá»‰nh sá»­a

### Phá»¥ Thuá»™c

- **@react-three/fiber**: TrÃ¬nh káº¿t xuáº¥t React cho Three.js
- **@react-three/drei**: CÃ´ng cá»¥ há»¯u Ã­ch cho React Three Fiber
- **three**: ThÆ° viá»‡n Ä‘á»“ há»a 3D

### Loáº¡i Váº­t Thá»ƒ ÄÆ°á»£c Há»— Trá»£

- **HÃ¬nh CÆ¡ Báº£n**: `box`, `sphere`, `cylinder`
- **Ãnh SÃ¡ng**: `light` (Ã¡nh sÃ¡ng Ä‘iá»ƒm vá»›i trá»±c quan hÃ³a)
- **ThÃ nh Pháº§n TÃ¹y Chá»‰nh** (dá»± kiáº¿n): `island`, `sand`, `ocean`, `cloud`, `rock`, `wind`

## Äa NgÃ´n Ngá»¯

TrÃ¬nh chá»‰nh sá»­a há»— trá»£ nhiá»u ngÃ´n ngá»¯:

- **Tiáº¿ng Anh** (`locales/en/editor3d.json`)
- **Tiáº¿ng Viá»‡t** (`locales/vi/editor3d.json`)

Táº¥t cáº£ vÄƒn báº£n UI Ä‘Æ°á»£c báº£n Ä‘á»‹a hÃ³a vÃ  chuyá»ƒn Ä‘á»•i dá»±a trÃªn tÃ¹y chá»n ngÃ´n ngá»¯ cá»§a ngÆ°á»i dÃ¹ng.

## Kháº¯c Phá»¥c Sá»± Cá»‘

### Cáº£nh khÃ´ng lÆ°u Ä‘Æ°á»£c
- Kiá»ƒm tra console cá»§a trÃ¬nh duyá»‡t Ä‘á»ƒ tÃ¬m lá»—i
- Äáº£m báº£o localStorage Ä‘Æ°á»£c báº­t trong trÃ¬nh duyá»‡t
- Thá»­ xÃ³a localStorage vÃ  táº¡o cáº£nh má»›i

### Váº­t thá»ƒ khÃ´ng xuáº¥t hiá»‡n trong khung nhÃ¬n
- Kiá»ƒm tra váº­t thá»ƒ cÃ³ tá»a Ä‘á»™ vá»‹ trÃ­ há»£p lá»‡
- Äáº£m báº£o camera cÃ³ thá»ƒ nhÃ¬n tháº¥y váº­t thá»ƒ (Ä‘iá»u chá»‰nh zoom/vá»‹ trÃ­)
- XÃ¡c minh dá»¯ liá»‡u váº­t thá»ƒ Ä‘Æ°á»£c lÆ°u trá»¯ Ä‘Ãºng trong state

### Äiá»u khiá»ƒn biáº¿n Ä‘á»•i khÃ´ng hoáº¡t Ä‘á»™ng
- Äáº£m báº£o váº­t thá»ƒ Ä‘Æ°á»£c chá»n Ä‘Ãºng cÃ¡ch
- Kiá»ƒm tra váº­t thá»ƒ cÃ³ tham chiáº¿u mesh
- XÃ¡c minh TransformControls Ä‘Æ°á»£c gáº¯n káº¿t Ä‘Ãºng cÃ¡ch

## TÃ i Liá»‡u Tham Kháº£o API

### Editor3DLayout Props

```typescript
interface Editor3DLayoutProps {
  translations: {
    viewport: { ... },
    hierarchy: { ... },
    properties: { ... },
    assets: { ... }
  };
}
```

### HomepageScene3D Props

```typescript
interface HomepageScene3DProps {
  className?: string;        // CÃ¡c class CSS bá»• sung
  enableControls?: boolean;  // Báº­t Ä‘iá»u khiá»ƒn camera (máº·c Ä‘á»‹nh: false)
}
```

---

**LÆ°u Ã½**: ÄÃ¢y lÃ  phiÃªn báº£n triá»ƒn khai ban Ä‘áº§u. TrÃ¬nh chá»‰nh sá»­a cung cáº¥p chá»©c nÄƒng cá»‘t lÃµi Ä‘á»ƒ táº¡o vÃ  quáº£n lÃ½ cáº£nh 3D. CÃ¡c tÃ­nh nÄƒng vÃ  cáº£i tiáº¿n bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c thÃªm vÃ o dá»±a trÃªn pháº£n há»“i vÃ  yÃªu cáº§u cá»§a ngÆ°á»i dÃ¹ng.
